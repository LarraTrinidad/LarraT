---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}

library("ggpubr")
library(ggplot2)
library(circular)
library(tidyverse)
library("scales")


data <- read.csv("Angles_Division_Combined.csv", na.strings="unknown")
data


breaks <- c(-180,-170,-160,-150,-140,-130,-120,-110,-100,-90,-80,-70,-60,-50,-40,-30,-20,-10,0,10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180)
tags <- c("[-180,-170)","[-170,-160)","[-160,-150)","[-150,-140)","[-140,-130)","[-130,-120)","[-120,-110)","[-110,-100)","[-100,-90)","[-90,-80)","[-80,-70)","[-70,-60)","[-60,-50)","[-50,-40)","[-40,-30)","[-30,-20)","[-20,-10)","[-10,0)","[0,10)", "[10,20)", "[20,30)", "[30,40)", "[40,50)", "[50,60)", "[60,70)", "[70,80)", "[80,90)","[90,100)", "[100,110)", "[110,120)", "[120,130)", "[130,140)", "[140,150)", "[150,160)", "[160,170)", "[170,180)")


group_tags_1a <- cut(data$Corrected_Angle, breaks=breaks, right=TRUE, labels=tags)
group_tags_1a <- na.omit(group_tags_1a)
summary(group_tags_1a)
Sa <- as_tibble(summary(group_tags_1a))
Sa

ggplot(data=as_tibble(group_tags_1a), mapping=aes(x=value)) + geom_bar(fill="#00BFC4",color="white",alpha=20,width=1)  + stat_count(geom="text", aes(label=sprintf("%.2f",..count../length(group_tags_1a))),vjust=-0.5,size=2.5,hjust=0.5,angle=45) +  scale_x_discrete(drop = FALSE) + coord_polar(start=pi/2, direction =-1) + scale_fill_brewer(palette="Greens") +   theme(axis.text = element_blank(), axis.ticks = element_blank()) + labs(title = "Absolute angle of division (original)") + theme_transparent()
ggsave("Absolute angle of division (original).png", width = 10, height = 8, unit = "in")   
ggplot(data=as_tibble(group_tags_1a), mapping=aes(x=value)) + geom_bar(fill="#00BFC4",color="white",alpha=20,width=1)  + stat_count(geom="text", aes(label="")) +  scale_x_discrete(drop = FALSE) + coord_polar(start=pi/2, direction =-1) + scale_fill_brewer(palette="Greens") +   theme(axis.text = element_blank(), axis.ticks = element_blank()) + labs(title = "Absolute angle of division (original)")  + theme_transparent()
ggsave("Absolute angle of division .png", width = 10, height = 8, unit = "in")   




# FLIPPED


group_tags_1b <- cut(data$FLIPPED, breaks=breaks, right=TRUE, labels=tags)
group_tags_1b <- na.omit(group_tags_1b)
summary(group_tags_1b)
Sb <- as_tibble(summary(group_tags_1b))
Sb

ggplot(data=as_tibble(group_tags_1b), mapping=aes(x=value)) + geom_bar(fill="#00BFC4",color="white",alpha=20,width=1)  + stat_count(geom="text", aes(label=sprintf("%.2f",..count../length(group_tags_1b))),vjust=-0.5,size=2.5,hjust=0.5,angle=45) +  scale_x_discrete(drop = FALSE) + coord_polar(start=pi/2, direction =-1) + scale_fill_brewer(palette="Greens") +   theme(axis.text = element_blank(), axis.ticks = element_blank()) + labs(title = "Absolute angle of division (original)") + theme_transparent()
ggsave("Absolute angle of division FLIPPED (original).png", width = 10, height = 8, unit = "in")   
ggplot(data=as_tibble(group_tags_1b), mapping=aes(x=value)) + geom_bar(fill="#00BFC4",color="white",alpha=20,width=1)  + stat_count(geom="text", aes(label="")) +  scale_x_discrete(drop = FALSE) + coord_polar(start=pi/2, direction =-1) + scale_fill_brewer(palette="Greens") +   theme(axis.text = element_blank(), axis.ticks = element_blank()) + labs(title = "Absolute angle of division (original)")  + theme_transparent()
ggsave("Absolute angle of division FLIPPED .png", width = 10, height = 8, unit = "in")   




# Normality tests

#If the sample size is large enough (n > 30), we can ignore the distribution of the data and use parametric tests.
#The central limit theorem tells us that no matter what distribution things have, the sampling distribution tends to be normal if the sample is large enough (n > 30).

angles = data$Corrected_Angle
print("Angles")
mean(angles)
print("Standard Deviation")
sd(angles)
ggdensity(angles, main = "Density plot of angles", xlab = "Angle of Division")

ggqqplot(angles)

library("car")
qqPlot(angles)

shapiro.test(angles) #The null hypothesis of these tests is that “sample distribution is normal”. If the test is significant, the distribution is non-normal.
#From the output, the p-value > 0.05 implying that the distribution of the data are not significantly different from normal distribution. In other words, we can assume the normality.

library(MASS)
Sb$value
obs <- c(Sb$value[10:27])
exp <- c(1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18)
chisq.test(obs, p = exp)

#chisq.test(angles)

ggplot(data=as_tibble(group_tags_1b), mapping=aes(x=value)) + geom_bar(fill="#00BFC4",color="white",alpha=20,width=1)  + stat_count(geom="text", aes(label="")) +  scale_x_discrete(drop = FALSE)





# Normalised to SOPs

group_tags_1bn <- cut(data$FLIPPED_Normalised, breaks=breaks, right=TRUE, labels=tags)
group_tags_1bn <- na.omit(group_tags_1bn)
summary(group_tags_1bn)
Sbn <- as_tibble(summary(group_tags_1bn))
Sbn

ggplot(data=as_tibble(group_tags_1bn), mapping=aes(x=value)) + geom_bar(fill="#00BFC4",color="white",alpha=20,width=1)  + stat_count(geom="text", aes(label=sprintf("%.2f",..count../length(group_tags_1bn))),vjust=-0.5,size=2.5,hjust=0.5,angle=45) +  scale_x_discrete(drop = FALSE) + coord_polar(start=pi/2, direction =-1) + scale_fill_brewer(palette="Greens") +   theme(axis.text = element_blank(), axis.ticks = element_blank()) + labs(title = "Absolute angle of division (original)") + theme_transparent()
ggsave("Absolute angle of division FLIPPED (original_normalised).png", width = 10, height = 8, unit = "in")   
ggplot(data=as_tibble(group_tags_1bn), mapping=aes(x=value)) + geom_bar(fill="#00BFC4",color="white",alpha=20,width=1)  + stat_count(geom="text", aes(label="")) +  scale_x_discrete(drop = FALSE) + coord_polar(start=pi/2, direction =-1) + scale_fill_brewer(palette="Greens") +   theme(axis.text = element_blank(), axis.ticks = element_blank()) + labs(title = "Absolute angle of division (original)")  + theme_transparent()
ggsave("Absolute angle of division FLIPPED normalised .png", width = 10, height = 8, unit = "in")   




# Normality tests

#If the sample size is large enough (n > 30), we can ignore the distribution of the data and use parametric tests.
#The central limit theorem tells us that no matter what distribution things have, the sampling distribution tends to be normal if the sample is large enough (n > 30).

anglesn = data$FLIPPED_Normalised
print("Angles")
mean(anglesn)
print("Standard Deviation")
sd(anglesn)
ggdensity(anglesn, main = "Density plot of angles", xlab = "Angle of Division")

ggqqplot(anglesn)

library("car")
qqPlot(anglesn)

shapiro.test(anglesn) #The null hypothesis of these tests is that “sample distribution is normal”. If the test is significant, the distribution is non-normal.
#From the output, the p-value > 0.05 implying that the distribution of the data are not significantly different from normal distribution. In other words, we can assume the normality.

library(MASS)
Sbn$value
obs <- c(Sbn$value[19:36])
exp <- c(1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18,1/18)
chisq.test(obs, p = exp)

#chisq.test(angles)

ggplot(data=as_tibble(group_tags_1bn), mapping=aes(x=value)) + geom_bar(fill="#00BFC4",color="white",alpha=20,width=1)  + stat_count(geom="text", aes(label="")) +  scale_x_discrete(drop = FALSE)

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+ShiDs+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

